# AGC019

## [AGC019] D - Shift and Flip

### 方針

最終的に右にシフトした量を d (-N <= d <= N) と固定する。

dを固定することにより、反転しなければいけないAのビットが自動的に決まる。
A_i を反転しなければならないとき、もし i から i + d まで動かす間に B_j = 1 となるビットがあるなら、そのタイミングで反転すればいいので、特に考えなくていい。

そのようなビットが存在しないときについて考える。iより左側でB_j = 1となる最も近いjをx_i, iより右側でB_j = 1となる最も近いjをy_iとする。このようにして複数の組(x_i, y_i)を得る。
シフトの回数を最小にするためには、以下のようなkを求める。
d + 2 * k が必要なシフト回数となる。

$$
\min k = X + Y\\
\mbox{s.t. } x_i \le X \mbox{ or } y_i \le Y, \forall i
$$

これは、(x_i, y_i)をx_iでソートし平面走査を行うことで求めることができる。

### 計算量

O( N^2 log N )


### keywords

bitset, shift, flip, 平面走査
