# ARC 061

## E - すぬけ君の地下鉄旅行 / Snuke's Subway Trip [AC]

### 方針

頂点の構造を少し工夫したグラフを作って dijkstra 法を使う。

単に駅を頂点としたグラフでは目的のコストを求められない。そこで、以下の様な有向グラフを考える。

#### 頂点

駅を、1つの頂点ではなく、MAX_C * 2 + 1 個の頂点から構成する。

* 0 〜 MAX_C - 1 : 到着用頂点(ARR)
* MAX_C 〜 MAX_C * 2 - 1 : 出発用頂点(DEP)
* MAX_C * 2 : 乗換用頂点(TRS)

とする。ARR と DEP は鉄道会社ごとに用意し、TRS は駅ごとに1つとする。

#### 辺

駅の内部については、各駅において、各会社ごとに ARR -> DEP, ARR -> TRS, TRS -> DEP に三角形を成すように有向辺を張る。

駅間については、例えば s <\-> t を結びたい場合は、s の DEP -> t の ARR, t の DEP -> s の ARR にそれぞれ有向辺を張る。

#### コスト

TRS -> DEP の辺のみ 1 とし、残りの辺はすべて 0 とする。

#### 解

上記のグラフ上で、始点駅の TRS の頂点から終点の駅の TRS の頂点までの最短距離をダイクストラ法を用いて求めればいい。


#### その他

駅数 × 鉄道会社数 は非常に大きな数になるので、駅の内部の頂点や辺は必要なものだけ作成するようにした。また、頂点を保持するために、普段は配列を用いるところを今回は hash (= unordered_map) を用いた。


### 計算量

O( M log N )


### keywords

dijkstra, unordered_map, 有向グラフ


