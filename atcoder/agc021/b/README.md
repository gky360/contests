# [AGC021] B - Holes

## 問題概要

2次元平面上のN点 (x_i, y_i) が与えられる。原点を中心とする半径R=10^10^10の円の中からランダムに点Pを選び、点Pから最も近い (x_i, y_i) を選ぶ、という操作を行う時、各 (x_i, y_i) が選ばれる確率を求めよ。

## 方針

R がとても大きいことに着目する。

R が大きいので、与えられたN点の凸包の内部の点の確率は0となる。

ある凸包上の点 p について、 p と凸包上で隣り合う点を q, r とする。
pq の垂直二等分線と qr の垂直二等分線によって 4 つに分けられた領域のうちの q を含む部分を T と呼ぶ。点 p の確率は T の面積に比例する。

ここで、2つの垂直二等分線を原点に持っていくことを考えると、 T の面積は O(R^2) であるのに対し面積の変化分は O(R) なので、面積の変化を無視できる。
従って結局、2本の垂直二等分線のなす角度が $2 \pi$ に占める割合が点 p の確率となる。


## 計算量

O( N log N )


## keywords

凸包
