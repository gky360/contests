# CODE FESTIVAL 2016 qual B

## [AC][CODEFESTIVAL2016 qualb] E - Lexicographical disorder

### 方針

trie 木を使う。

ALPH = 26 とする。

trie 木を構築し、各ノードには自分のノードからの部分木に含まれる単語の数を持たせておく。
これだけでも O( 文字数の合計 * ALPH + 文字数の合計 * Q * ALPH ) の解法は可能だが、このままでは間に合わないので、前処理を行う。

ある2文字 c1, c2 の間にだけ順序関係 c1 < c2 があると仮定した場合の、文字列 S_i より小さい文字列の個数を、cnt[i][c1][c2] に記憶しておく。

この前処理を行うことによって、クエリが来たときは、 $(\forall c1, \forall c2 | クエリで指定された辞書順において c1 < c2 となっている )$ ようなすべての c1, c2 について、cnt[k - 1][c1][c2] の合計を求めれば、クエリの辞書順で S_i より小さい文字列の個数を求めることができる。

#### その他

ある文字列が別の文字列の接頭辞と成っている場合があるので、すべての単語が葉となるとは限らない。すべての単語を葉としたいときは、文字列の最後に終端記号 `'{'` をつけることで、実現できる。
ちなみに `'{'` は、ASCII コード表で `'z'` の次の文字である。


### 計算量

O( 文字数の合計 * ALPH + Q * ALPH^2 )


### keywords

trie 木, 辞書順
