# TDPC

## [TDPC] O - 文字列

### 問題概要

`a`, `b`, ..., `z` をそれぞれ freq_1, freq_2, ..., freq_26 個含む文字列のうち、同じ文字が隣り合わない文字列の個数を求める。

### 方針

```
dp[i][j] = (i 文字目まで見たときに同じ文字が隣う箇所が j 箇所ある文字列の個数)
```

とする。ただし、 freq_i = 0 となる文字は無視する。また、 sum[i] = \sum_{k=1}^{i} freq_i　とする。

文字をk個のグループに分割し、そのうち l グループを j 箇所のうちの何処かに、残り k-l グループを残り sum[i] + 1 - j 箇所に入れると考えると、更新式は、

```
dp[i + 1][j - l + freq[i] - k] += dp[i][j] * comb[freq[i] - 1][k - 1] * comb[j][l] * comb[sum[i] + 1 - j][k - l]
```

となる。ただし、 `comb[i][j]` は iCk である。


### 計算量

O( 26^2 freq^3 )


### keywords

dp, 数え上げ, 組み合わせ
