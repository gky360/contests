# [ARC085] E - MUL

## 問題概要

a_1, a_2, …, a_N が与えられる。
それぞれを選ぶか選ばないかを決め、選んだものの総和の最大値を求める。
ただし、 a_i を選んだ場合は a_{2i}, a_{3i}, … も選ばなければならない。
-10e9 <= a_i <= 10e9


## 方針

最小カットを使って、 a_i > 0 なる a_i の総和からの減少量の最小値を求める。

各iについて、以下のように辺を張る。

1. a_i <= 0 => S -> i に容量 -a_i の辺を張る
2. a_i > 0 => i -> T に容量 a_i の辺を張る
3. i -> 2i, i -> 3i, … に容量 \inf の辺を張る

各辺をカットすることにはそれぞれ以下のような意味がある。

- 1の辺をカットする -> a_i を選ばないことで総和が a_i 減少する
- 2の辺をカットする -> a_i を選ぶことで総和が a_i 減少する
- 3の辺 -> 容量が \inf なのでカットできない


この問題は典型問題であり、「燃やす埋める問題」や Project Selection などと呼ばれているらしい。


## 計算量

頂点数 O( N ), 辺数 O( N log N ) である。最小カット(=最大流)の計算に Dinic 法を使えば、

O( V^2 E ) = O( N^3 log N )

となる。


## keywords

燃やす埋める問題, Project Selection, 最小カット
