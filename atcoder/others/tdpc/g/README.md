# TDPC

## [TDPC] G - 辞書順

### 問題概要

文字列 s の部分列を辞書順に並べたときの K 番目の文字列を求める。

### 方針

以下のようなdpを考える。
$$
dp[i] = (s[i] を先頭にした部分列の数)
$$

この dp の更新式は、i文字目以降で最初に文字cが出現する位置を $next[i][c]$ とすると、
$$
dp[i] = 1 + \sum_{c \in 'a' \cdots 'z'} dp[next[i + 1][c]]
$$
となる。この式を用いて dp のテーブルを後ろから埋めておく。

次に、この dp のテーブルを用いて、 K 番目の部分列を求める。

i 文字目を使うことが分かっていて、i文字目を先頭とする部分列のうち k 番目のものを求めることを考える。 $dp_i = 1 + a + b + \cdots + z$ とするi文字目よりあとの文字列は、

- $k = 1$ なら、空文字列
- $1 < k <= 1 + a$ なら、 $next[i + 1][a]$ を先頭とする部分列で k - 1 番目のもの
- $1 + a < k <= 1 + a + b$ なら、 $next[i + 1][b]$ を先頭とする部分列で k - 1 - a 番目のもの
- ...
- $1 + a + \cdots + z < k$ なら、存在しない。

となる。これを繰り返すことで、dpのテーブルから K 番目の文字列を復元する。

### 計算量

O( |s| )


### keywords

dp, 部分列, 辞書順
