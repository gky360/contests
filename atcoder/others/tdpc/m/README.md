# TDPC

## [TDPC] M - 家

### 方針

bit dp と行列累乗。

まず、

```
dp[i][j][b] = (ある1つの階について、集合 b で表される部屋を通って部屋iから部屋jへ行く経路の数)
```

として、まず1階分の部屋iから部屋jへの経路の数 `s[i][j]` を求める。

次に、行列 s のH乗を計算する（ある隣接行列Aの表すグラフ上での長さlのバスの個数は A^l で表されるので）。Hが大きいが、繰り返し二乗法を使うと間に合う。


### 計算量

O( R^3 2^R )


### keywords

dp, bit dp, 行列累乗, 繰り返し二乗法
