# AtCoder Grand Contest 005

## C - Tree Restoring [AC-]

### 方針

木の直径に着目する。

木の直径

:   その木における最長パスの長さ

木の直径が dist(a, b) だとすると、 a, b 間のあるノード p から他のノードまでの距離の最大値 f(p) は、 max(dist(a, p), dist(b, p)) に一致する。つまり、下のような感じ。

```
    (a)-( )-( )-( )-(b)
f    4   3   2   3   4

    (a)-( )-( )-( )-( )-(b)
f    5   4   3   3   4   5
```

まず、これが作れなかったら `Impossible` と判定できる。

さらに、余ったノードについて考える。余ったノードは、下図のように木の直径からぶら下げて行けばいい。ただし、ぶら下げたノードの f は木の直径上のノードの f から必ず1増えてしまうことから、 f <= (dist(a, b) + 1) / 2 なるノードが余っていた場合には、 `Impossible` となる。すべてのノードが f > (dist(a, b) + 1) / 2 ならば、 `Possible` である。

```
             4
            ( )
             |
    (a)-( )-( )-( )-( )-(b)
f    5   4   3   3   4   5
```

[解説](http://agc005.contest.atcoder.jp/data/agc/005/editorial.pdf)


### 計算量

O( N log N )


### keywords

木の直径, 木, 最長パス, 最長距離, set

